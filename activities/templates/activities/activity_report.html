{% extends 'activities/base.html' %}
{% load static %}

{% block title %}Activity Report{% endblock %}  

{% block content %}

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
<link rel="stylesheet" href="{% static 'activities/css/activity_report.css' %}">

<body>
    <section class="section">
        <div class="container">
            <div class="is-relative header-container">
                <!-- Child and Activity Names -->
                <div class="has-text-centered child-activity-header">
                    <h2 class="title">{{ child_name }}</h2>
                    <h2 class="subtitle">{{ activity_name }} Activity</h2>
                </div>
                <!-- Button -->
                <a href="{% url 'selectactivity' child_id %}" class="button select-activity-button">
                    Select Another Activity
                </a>
            </div> 
            {% if attempts_by_choice %}
                {% for choice, attempts in attempts_by_choice.items %}
                <div class="columns is-multiline">
                    <div class="column is-full">
                        <h5 class="title is-5">{{ choice }}</h5>
                    </div>
                    {% for attempt in attempts %}
                    <div class="column is-4">
                        <div class="card has-shadow">
                            <div class="card-content">
                                <h6 class="title is-6 has-text-centered">At: {{ attempt.timestamp }}</h6>
                                <div class="score-circle">
                                    <svg viewBox="0 0 36 36" class="circular-chart {% if attempt.score >= 50 %}green{% else %}red{% endif %}">
                                        <path class="circle-bg" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                        <path class="circle" stroke-dasharray="{{ attempt.score }}, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" />
                                    </svg>
                                    <div class="circle-text"><strong>{{ attempt.score|floatformat:2 }}%</strong></div>
                                </div>
                                <p class="card-text has-text-centered">
                                    <strong>Right:</strong> {{ attempt.right_answers }} |
                                    <strong>Wrong:</strong> {{ attempt.wrong_answers }} <br>
                                    <strong>Level:</strong> {{ attempt.level }}
                                </p>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% endfor %}
            {% else %}
                <div class="notification no-attempts-notification">
                    <p>
                        <strong>{{ child_name }}</strong> has not made any attempts for the <strong>{{ activity_name }}</strong> activity yet.
                    </p>
                    <p>Encourage them to participate to track their progress!</p>
                </div>
            {% endif %}
        </div>
    </section>
</body>

{% endblock %}
